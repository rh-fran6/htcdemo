apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-content
  namespace: {{ .Values.namespace | default .Release.Namespace }}
data:
  index.html: |
    <!doctype html>
    <html lang="en">
      <head>
        <meta charset="utf-8">
        <title>Welcome to OpenShift NGINX ðŸš€</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <style>
          :root { --bg1:#ee0000; --bg2:#c41212; --ink:#ffffff; --accent:#ffeb3b; }
          * { box-sizing: border-box; }
          body {
            margin: 0; min-height: 100vh; color: var(--ink);
            background: radial-gradient(1200px 600px at 10% 10%, #ff5959, var(--bg1)) fixed,
                        linear-gradient(135deg, var(--bg1), var(--bg2)) fixed;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            display:flex; align-items:center; justify-content:center; padding: 2rem;
          }
          .card {
            background: rgba(255,255,255,0.08);
            border-radius: 16px; padding: 2rem 2.4rem; max-width: 980px; width: 100%;
            box-shadow: 0 12px 28px rgba(0,0,0,0.35); backdrop-filter: blur(8px);
          }
          h1 { font-size: clamp(2rem, 4vw, 3.25rem); margin: 0 0 .5rem 0; }
          p  { font-size: 1.15rem; margin: 0 0 1.5rem 0; }
          ul { line-height: 1.85; font-size: 1.05rem; padding-left: 1.25rem; }
          code { background: rgba(0,0,0,0.45); padding: 2px 6px; border-radius: 6px; color: var(--accent); }
          .pills { margin-top: 1rem; display:flex; gap:.5rem; flex-wrap: wrap; }
          .pill { display:inline-block; padding:.35rem .7rem; border-radius:999px; background:rgba(255,255,255,0.12); font-size:.95rem; }
          .muted { opacity: .85; }
        </style>
      </head>
      <body>
        <main class="card">
          <h1>ðŸŽ‰ OpenShift Demo Running on NGINX ðŸŽ‰</h1>
          <p class="muted">
            Served by <strong>NGINX (non-root)</strong> inside your OpenShift cluster.
          </p>

          <h3>Cluster Details</h3>
          <ul>
            <li><strong>Cluster Name:</strong> {{ .Values.clusterName }}</li>
            <li><strong>Project (Namespace):</strong> {{ .Values.namespace | default .Release.Namespace }}</li>
            <li><strong>Pod Name:</strong> <code><!--# include file="/etc/podinfo/podname" --></code></li>
            <li><strong>Hostname (pod):</strong> <code><!--# echo var="hostname" --></code></li>
            <!-- Zone only renders if you label the pod with topology.kubernetes.io/zone -->
            <li><strong>Zone:</strong> <code><!--# include file="/etc/podinfo/zone" --></code></li>
            <li><strong>Served At (GMT):</strong> <code><!--# echo var="date_gmt" --></code></li>
          </ul>

          <div class="pills">
            <span class="pill">Replica: <code><!--# include file="/etc/podinfo/podname" --></code></span>
            <span class="pill">Namespace: <code><!--# include file="/etc/podinfo/namespace" --></code></span>
          </div>
        </main>
      </body>
    </html>
  default.conf: |
    server {
      listen 8080;
      server_name _;
      root /usr/share/nginx/html;
      index index.html;

      # Enable Server Side Includes to render downward API files & time
      ssi on;
      ssi_types text/html;
      ssi_silent_errors on;

      add_header Cache-Control "no-store" always;

      location / {
        try_files $uri $uri/ =404;
      }
    }
