destServer: &dest https://kubernetes.default.svc
argocdNamespace: &ns openshift-gitops
appANamespace: &appA app-a

selfRepoURL: &selfRepo https://github.com/rh-fran6/htcdemo.git
selfRev: &selfRev main

argocd-apps:
  applications:
    - name: eso-operator-olm
      namespace: *ns
      project: platform
      annotations: { argocd.argoproj.io/sync-wave: "-2" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/operators/external-secrets-olm
      destination:
        server: *dest
        namespace: openshift-operators
      syncPolicy:
        automated: { prune: true, selfHeal: true }
        syncOptions: [CreateNamespace=true]
    
    - name: hawtio
      namespace: *ns
      project: platform
      annotations: { argocd.argoproj.io/sync-wave: "-2" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/operators/hawtio
      destination:
        server: *dest
        namespace: openshift-operators
      syncPolicy:
        automated: { prune: true, selfHeal: true }
        syncOptions: [CreateNamespace=true]
    
    - name: dev-spaces
      namespace: *ns
      project: platform
      annotations: { argocd.argoproj.io/sync-wave: "-2" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/operators/dev-spaces
      destination:
        server: *dest
        namespace: openshift-operators
      syncPolicy:
        automated: { prune: true, selfHeal: true }
        syncOptions: [CreateNamespace=true]

    - name: oauth-okta
      namespace: *ns
      project: platform
      annotations: { argocd.argoproj.io/sync-wave: "1" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/infra/oauth-okta
      destination:
        server: *dest
        namespace: *ns
      syncPolicy:
        automated: { prune: true, selfHeal: true }

    - name: cluster-autoscaler
      namespace: *ns
      project: platform
      annotations: { argocd.argoproj.io/sync-wave: "1" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/infra/cluster-autoscaler
      destination:
        server: *dest
        namespace: *ns
      syncPolicy:
        automated: { prune: true, selfHeal: true }

    - name: app-a-nginx
      namespace: *ns
      project: app-a
      annotations: { argocd.argoproj.io/sync-wave: "5" }
      finalizers: [resources-finalizer.argocd.argoproj.io]
      source:
        repoURL: *selfRepo
        targetRevision: *selfRev
        path: clusterbootstrap/apps/nginx            
      destination:
        server: *dest
        namespace: *appA
      syncPolicy:
        automated: { prune: true, selfHeal: true }
        syncOptions: [CreateNamespace=true]
