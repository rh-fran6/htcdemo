kubeconfig: "~/.kube/config"

# venv + paths
venv_path: ".venv"
collections_path: "./collections"
rendered_playbook_path: "./build/generated-playbook.yaml"

install_gitops_operator: true
gitops_channel: gitops-1.17
gitops_source: redhat-operators
gitops_source_namespace: openshift-marketplace
gitops_approval: Automatic

# Namespaces
argocd_namespace: "openshift-gitops"
app_a_namespace: "app-a"
apps_namespaces: 
  - "app-b"
  - "app-c"
target_namespace: "my-apps"

# Git host + repo creds
create_workload_github_secret: false 
github_host: "github.com"
github_repo_url: "https://github.com/rh-fran6/htcdemo.git"
github_username: "rh-fran6"

# External Secret Operator Backhaul to AWS SM
create_aws_sm_secret: true

# Argo CD RBAC (parameterized)
rbac_scopes: "[groups]"
rbac_default_policy: "role:readonly"
rbac_groups:
  - { name: "admin-team", role: "admin", users: [kubeadmin, kube] }
  - { name: "devops-team", role: "devops", users: [thisuser, thatuser, tom cruise, carlos-platter]}
  - { name: "app-a-team", role: "app-a", users: [user1] }
  - { name: "noc-team",   role: "noc", users: [] }
rbac_roles:
  - name: admin
    permissions:
      - { resource: "*", action: "*", object: "*/*"}
  - name: "devops"
    permissions:
      - { resource: "applications", action: "*",     object: "platform/*" }
      - { resource: "projects",     action: "get",   object: "platform" }
      - { resource: "clusters",     action: "*",     object: "*" }
      - { resource: "repositories", action: "*",     object: "*" }
      - { resource: "logs",         action: "get",   object: "*" }
      - { resource: "exec",         action: "create",object: "*" }
      - { resource: "certificates", action: "*",     object: "*" }
      - { resource: "accounts",     action: "get",   object: "*" }
      - { resource: "gpgkeys",      action: "*",     object: "*" }
  - name: "app-a"
    permissions:
      - { resource: "applications", action: "get",  object: "app-a/*" }
      - { resource: "applications", action: "sync", object: "app-a/*" }
      - { resource: "projects",     action: "get",  object: "app-a" }
  - name: "noc"
    permissions:
      - { resource: "applications", action: "get",  object: "apps/*" }
      - { resource: "projects",     action: "get",  object: "apps" }

bootstrap_enabled: true
bootstrap_app_name: "bootstrap"
bootstrap_repo_url: "{{ github_repo_url }}" 
bootstrap_target_revision: "main"
bootstrap_path: "bootstrap"                  
bootstrap_project: "platform"   

# {% for g in rbac_groups | default([]) %}
#     - name: Ensure OpenShift group {{ g.name }} exists
#       kubernetes.core.k8s:
#         kubeconfig: "{{ kubeconfig }}"
#         state: present
#         merge_type: merge
#         definition:
#           apiVersion: user.openshift.io/v1
#           kind: Group
#           metadata:
#             name: "{{ g.name }}"
#           users: [{{ g.users | map('quote') | join(', ') }}]
# {% endfor %}





